# 循环指令

循环也是改变指令执行顺序的一种方式，循环操作重复的执行，直到满足条件。我们可以使用条件跳转指令来创建循环，但事实上汇编语言中有更简单的循环指令系列。

循环指令使用ECX寄存器作为计数器，随着循环指令的执行自动递减它的值，并且不会影响EFLAGS寄存器的标志位，当ecx寄存器值到达0时，0标志不会被设置。循环指令有如下：loop（循环直到ecx寄存器为0）、loope/loopz（循环直到ecx寄存器为0或没有设置ZF标志）、loopne/loopnz（循环直到ecx寄存器为0或设置了ZF标志）。

loope/loopz和loopne/loopnz指令提供了监视0标志的附加功能。指令的使用格式为：
```
loop addr
```
addr是要跳转到的程序代码位置的标签名称。在循环开始之前，必须在ecx寄存器中设置执行迭代的次数值。如下:
```
#loop.s
.section .text
.globl _start
_start:
    movl $10, %ecx
    movl $0, %eax
here_loop:
    addl %ecx, %eax
    loop here_loop

    movl %eax, %ebx
    movl $1, %eax
    int $0x80</span>
```
程序简单循环计算0到10的累加和，然会程序返回累加值。make，运行结果如下：
```
$ make
as -o loop.o loop.s --gstabs
ld -o loop loop.o
$ ./loop
$ echo $?
55
$
```
